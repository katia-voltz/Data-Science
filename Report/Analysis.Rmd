---
title: "Analysis"
output: html_document
---


```{r, echo = FALSE, message = FALSE}
source(here::here("scripts/Setup.R"))
```


### Work environment 


# FORWARD INDUCTION

```{r, echo = FALSE, message = FALSE}
mod0 <- lm(tab_Tot$Mental_Health~1)
summary(mod0)
mod1 <- lm(tab_Tot$Mental_Health~tab_Tot$Income_Inequality)
summary(mod1)
mod2 <- lm(tab_Tot$Mental_Health~tab_Tot$Income_Inequality+tab_Tot$wages)
summary(mod2)
mod3 <- lm(tab_Tot$Mental_Health~tab_Tot$Income_Inequality+tab_Tot$wages+tab_Tot$Working_Age)
summary(mod3)
```


# CLUSTER ANALYSIS

We also wanted to study our problem through another perspective, that of the countries. Indeed, we could notice on the first plots, some countries adopt more extreme behaviors (position separated from the others) and it is often the same across the different variables. A good way to analyze this is to group our countries using clusters. The goal is to see if the work environment has more impact in some countries than in others on the mental health of its population. 

```{r, echo = FALSE, message = FALSE}
# Income Inequality
data_t0 <- tab_Tot[-1]
data_t0 <- data_t0[,c(2,1)]
mean_data <- apply(data_t0, 2, mean)
std <- apply(data_t0,2,sd)
data_t0_std <- scale(data_t0, mean_data, std)
row.names(data_t0_std) <- tab_Tot[,1]
distance <- dist(data_t0_std)
hc <- hclust(distance)
avclust <- hclust(distance, method = "average")
km.res <- kmeans(data_t0_std, 5)
C0 <- fviz_cluster(km.res, data=data_t0_std, repel = TRUE)

# Wages
data_t1 <- tab_Tot[-1]
data_t1 <- data_t1[,c(3,1)]
mean_data <- apply(data_t1, 2, mean)
std <- apply(data_t1,2,sd)
data_t1_std <- scale(data_t1, mean_data, std)
row.names(data_t1_std) <- tab_Tot[,1]
distance <- dist(data_t1_std)
hc <- hclust(distance)
avclust <- hclust(distance, method = "average")
km.res <- kmeans(data_t1_std, 5)
C1 <- fviz_cluster(km.res, data=data_t1_std, repel = TRUE)

# Unemployment
data_t2 <- tab_Tot[-1]
data_t2 <- data_t2[,c(4,1)]
mean_data <- apply(data_t2, 2, mean)
std <- apply(data_t2,2,sd)
data_t2_std <- scale(data_t2, mean_data, std)
row.names(data_t2_std) <- tab_Tot[,1]
distance <- dist(data_t2_std)
hc <- hclust(distance)
avclust <- hclust(distance, method = "average")
km.res <- kmeans(data_t2_std, 5)
C2 <- fviz_cluster(km.res, data=data_t2_std, repel = TRUE)

# Working Age
data_t3 <- tab_Tot[-1]
data_t3 <- data_t3[,c(5,1)]
mean_data <- apply(data_t3, 2, mean)
std <- apply(data_t3,2,sd)
data_t3_std <- scale(data_t3, mean_data, std)
row.names(data_t3_std) <- tab_Tot[,1]
distance <- dist(data_t3_std)
hc <- hclust(distance)
avclust <- hclust(distance, method = "average")
km.res <- kmeans(data_t3_std, 5)
C3 <- fviz_cluster(km.res, data=data_t3_std, repel = TRUE)

# Work Time 
data_t4 <- tab_Tot[-1]
data_t4 <- data_t4[,c(6,1)]
mean_data <- apply(data_t4, 2, mean)
std <- apply(data_t4,2,sd)
data_t4_std <- scale(data_t4, mean_data, std)
row.names(data_t4_std) <- tab_Tot[,1]
distance <- dist(data_t4_std)
hc <- hclust(distance)
avclust <- hclust(distance, method = "average")
km.res <- kmeans(data_t4_std, 5)
C4 <- fviz_cluster(km.res, data=data_t4_std, repel = TRUE)

# GDP
data_t5 <- tab_Tot[-1]
data_t5 <- data_t5[,c(7,1)]
mean_data <- apply(data_t5, 2, mean)
std <- apply(data_t5,2,sd)
data_t5_std <- scale(data_t5, mean_data, std)
row.names(data_t5_std) <- tab_Tot[,1]
distance <- dist(data_t5_std)
hc <- hclust(distance)
avclust <- hclust(distance, method = "average")
km.res <- kmeans(data_t5_std, 5)
C5 <- fviz_cluster(km.res, data=data_t5_std, repel = TRUE)

# Put all the graphs together
plot_grid(C0, C1, C2, C3, C4, C5, labels=c("A","B","C","D","E","F"), ncol=3, nrow=2)
```



